@import '../../../theme/mixins.scss';

:host {
  ion-content {
    --background: linear-gradient(180deg, 
      rgba(var(--snackseat-primary-rgb), 0.03) 0%, 
      var(--ion-background-color) 20%
    );
  }
}

// Header Enhancements
ion-header {
  ion-toolbar {
    --background: var(--gradient-primary);
    --color: white;
    --border-width: 0;
    padding: var(--spacing-sm) 0;
    
    ion-title {
      font-weight: var(--font-weight-bold);
      font-size: var(--font-size-xl);
    }
    
    ion-button {
      --color: white;
      --background-hover: rgba(255, 255, 255, 0.1);
    }
  }
}

// Quick Actions Card
.quick-actions-card {
  margin: var(--spacing-md);
  border-radius: var(--ion-border-radius-lg);
  background: var(--gradient-secondary);
  box-shadow: var(--ion-box-shadow-md);
  animation: fadeInDown 0.5s ease-out;
  
  ion-card-content {
    padding: var(--spacing-md);
    
    ion-button {
      --background: white;
      --color: var(--snackseat-secondary);
      --border-radius: var(--ion-border-radius);
      --box-shadow: var(--ion-box-shadow-sm);
      font-weight: var(--font-weight-semibold);
      height: 48px;
      
      &:hover {
        --box-shadow: var(--ion-box-shadow);
        transform: translateY(-2px);
      }
    }
  }
}

// Search & Filter Section
.search-section {
  padding: var(--spacing-md);
  animation: fadeInUp 0.5s ease-out 0.1s both;
  
  .search-bar {
    margin-bottom: var(--spacing-md);
    
    ion-searchbar {
      --background: white;
      --border-radius: var(--ion-border-radius-lg);
      --box-shadow: var(--ion-box-shadow);
      --icon-color: var(--snackseat-primary);
      --placeholder-color: var(--ion-text-color-secondary);
      padding: 0;
    }
  }
  
  .filter-chips {
    display: flex;
    gap: var(--spacing-sm);
    overflow-x: auto;
    padding-bottom: var(--spacing-xs);
    @include hide-scrollbar;
    
    ion-chip {
      --background: white;
      --color: var(--ion-text-color);
      border: 2px solid var(--ion-border-color);
      font-weight: var(--font-weight-medium);
      transition: all var(--transition-fast);
      
      &.active {
        --background: var(--snackseat-primary);
        --color: white;
        border-color: var(--snackseat-primary);
      }
      
      &:hover {
        transform: scale(1.05);
      }
    }
  }
}

// Loading State
.loading-container {
  @include flex-column-center;
  padding: var(--spacing-xxl);
  animation: fadeIn 0.3s ease-in-out;
  
  ion-spinner {
    --color: var(--snackseat-primary);
    margin-bottom: var(--spacing-md);
  }
  
  p {
    color: var(--ion-text-color-secondary);
    font-size: var(--font-size-base);
    font-weight: var(--font-weight-medium);
  }
}

// Empty State
.empty-state {
  @include flex-column-center;
  padding: var(--spacing-xxl);
  text-align: center;
  animation: fadeInUp 0.5s ease-out;
  
  ion-icon {
    font-size: 80px;
    color: var(--ion-color-medium);
    margin-bottom: var(--spacing-lg);
    opacity: 0.5;
  }
  
  h2 {
    font-size: var(--font-size-2xl);
    font-weight: var(--font-weight-bold);
    margin-bottom: var(--spacing-sm);
    color: var(--ion-text-color);
  }
  
  p {
    color: var(--ion-text-color-secondary);
    font-size: var(--font-size-base);
    margin-bottom: var(--spacing-lg);
    max-width: 300px;
  }
  
  ion-button {
    --background: var(--gradient-primary);
    --border-radius: var(--ion-border-radius);
  }
}

// Shop Grid
ion-grid {
  padding: 0 var(--spacing-md) var(--spacing-md);
}

// Shop Card
.shop-card {
  margin-bottom: var(--spacing-lg);
  border-radius: var(--ion-border-radius-xl);
  box-shadow: var(--ion-box-shadow);
  overflow: hidden;
  transition: all var(--transition-base);
  animation: fadeInUp 0.5s ease-out both;
  
  @for $i from 1 through 20 {
    &:nth-child(#{$i}) {
      animation-delay: #{0.05 * $i}s;
    }
  }
  
  &:hover {
    transform: translateY(-8px);
    box-shadow: var(--ion-box-shadow-lg);
  }
  
  // Shop Image/Header
  .shop-header {
    position: relative;
    height: 180px;
    background: var(--gradient-primary);
    @include flex-center;
    overflow: hidden;
    
    &::before {
      content: '';
      @include absolute-full;
      background: var(--gradient-overlay);
      z-index: 1;
    }
    
    ion-icon {
      font-size: 64px;
      color: white;
      z-index: 2;
      opacity: 0.9;
    }
    
    .shop-status-badge {
      position: absolute;
      top: var(--spacing-md);
      right: var(--spacing-md);
      z-index: 3;
      padding: 6px 12px;
      border-radius: 20px;
      font-size: var(--font-size-xs);
      font-weight: var(--font-weight-bold);
      backdrop-filter: blur(10px);
      
      &.open {
        background: rgba(var(--snackseat-success-rgb), 0.9);
        color: white;
      }
      
      &.closed {
        background: rgba(var(--snackseat-danger-rgb), 0.9);
        color: white;
      }
    }
  }
  
  ion-card-header {
    padding: var(--spacing-md);
    background: white;

    ion-card-title {
      font-size: var(--font-size-xl);
      font-weight: var(--font-weight-bold);
      color: white;
      background: var(--snackseat-primary);
      padding: var(--spacing-xs) var(--spacing-sm);
      border-radius: var(--ion-border-radius-sm);
      margin-bottom: var(--spacing-xs);
      @include line-clamp(1);
    }
    
    ion-card-subtitle {
      font-size: var(--font-size-sm);
      font-weight: var(--font-weight-medium);
      color: var(--snackseat-primary);
      display: flex;
      align-items: center;
      gap: var(--spacing-xs);
      
      ion-icon {
        font-size: 16px;
      }
    }
  }
  
  ion-card-content {
    padding: 0 var(--spacing-md) var(--spacing-md);
    
    .description {
      margin-bottom: var(--spacing-md);
      color: var(--ion-text-color-secondary);
      font-size: var(--font-size-sm);
      line-height: 1.6;
      @include line-clamp(2);
    }
    
    // Info Grid
    .info-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: var(--spacing-sm);
      margin-bottom: var(--spacing-md);
      
      .info-item {
        background: var(--ion-color-light);
        padding: var(--spacing-sm);
        border-radius: var(--ion-border-radius-sm);
        
        .info-label {
          font-size: var(--font-size-xs);
          color: var(--ion-text-color-secondary);
          font-weight: var(--font-weight-medium);
          margin-bottom: 2px;
          display: flex;
          align-items: center;
          gap: 4px;
          
          ion-icon {
            font-size: 14px;
          }
        }
        
        .info-value {
          font-size: var(--font-size-base);
          font-weight: var(--font-weight-semibold);
          color: var(--ion-text-color);
          
          &.link {
            color: var(--snackseat-primary);
            text-decoration: none;
            @include truncate;
            display: block;
            
            &:hover {
              text-decoration: underline;
            }
          }
        }
      }
    }
    
    // Availability Section
    .availability-section {
      background: linear-gradient(135deg, 
        rgba(var(--snackseat-primary-rgb), 0.1) 0%, 
        rgba(var(--snackseat-secondary-rgb), 0.05) 100%
      );
      padding: var(--spacing-md);
      border-radius: var(--ion-border-radius);
      margin-bottom: var(--spacing-md);
      
      .availability-row {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: var(--spacing-sm);
        
        &:last-child {
          margin-bottom: 0;
        }
        
        .label {
          font-size: var(--font-size-sm);
          color: var(--ion-text-color-secondary);
          font-weight: var(--font-weight-medium);
        }
        
        .value {
          font-size: var(--font-size-base);
          font-weight: var(--font-weight-bold);
          color: var(--snackseat-primary);
        }
      }
    }
    
    // Action Buttons
    .action-buttons {
      display: flex;
      gap: var(--spacing-sm);
      
      ion-button {
        flex: 1;
        --border-radius: var(--ion-border-radius);
        --box-shadow: var(--ion-box-shadow-sm);
        height: 44px;
        font-weight: var(--font-weight-semibold);
        text-transform: none;
        
        &.reserve-btn {
          --background: var(--gradient-primary);
          
          &:hover {
            --box-shadow: var(--ion-box-shadow);
          }
        }
        
        &.directions-btn {
          --background: white;
          --color: var(--snackseat-secondary);
          --border-width: 2px;
          --border-style: solid;
          --border-color: var(--snackseat-secondary);
          
          &:hover {
            --background: var(--snackseat-secondary);
            --color: white;
          }
        }
      }
    }
  }
}

// Responsive Adjustments
@include mobile {
  .shop-card {
    .shop-header {
      height: 150px;
    }
    
    ion-card-content {
      .info-grid {
        grid-template-columns: 1fr;
      }
      
      .action-buttons {
        flex-direction: column;
        
        ion-button {
          width: 100%;
        }
      }
    }
  }
}

@include tablet-up {
  ion-grid {
    padding: 0 var(--spacing-lg) var(--spacing-lg);
  }
}

@include desktop {
  .shop-card {
    .shop-header {
      height: 200px;
    }
  }
}

// Skeleton Loader
.skeleton-shop-card {
  margin-bottom: var(--spacing-lg);
  border-radius: var(--ion-border-radius-xl);
  overflow: hidden;
  
  .skeleton-header {
    @include skeleton;
    height: 180px;
  }
  
  .skeleton-content {
    padding: var(--spacing-md);
    
    .skeleton-title {
      @include skeleton;
      height: 24px;
      width: 70%;
      margin-bottom: var(--spacing-sm);
    }
    
    .skeleton-subtitle {
      @include skeleton;
      height: 16px;
      width: 40%;
      margin-bottom: var(--spacing-md);
    }
    
    .skeleton-text {
      @include skeleton;
      height: 14px;
      margin-bottom: var(--spacing-xs);
      
      &:last-child {
        width: 80%;
      }
    }
  }
}
